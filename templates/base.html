<!DOCTYPE html>
<html lang="es">
<head>
  {% block head %}
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Gestor de Instalaciones{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  {% endblock %}
</head>
<body>
  {% block header %}
  <header class="main-header">
    <nav class="main-nav">
  <a href="{{ url_for('index') }}" class="brand-logo">Gestor de Instalaciones</a>
  <div class="nav-links">
    {% if 'id_usuario' in session %}
      <span class="welcome-message">Hola, {{ session.nombre }}</span>
      {% if session.get('es_admin') %}
        <a href="{{ url_for('admin') }}" class="nav-link nav-button">Panel de Admin</a>
    <a href="{{ url_for('gestion_tareas') }}" class="nav-link nav-button">Gesti贸n de Tareas</a>
    <a href="{{ url_for('nueva_instalacion') }}" class="nav-link nav-button">Nueva Instalaci贸n</a>
    <a href="{{ url_for('admin_tareas_calendario') }}" class="nav-link nav-button">Calendario de Tareas</a>


      {% else %}
        <a href="{{ url_for('mis_tareas') }}" class="nav-link nav-button">Mis Tareas</a>
        <a href="{{ url_for('mis_tareas_completadas') }}" class="nav-link nav-button">Tareas Completadas</a>
        <a href="{{ url_for('mis_tareas_completadas_calendario') }}" class="nav-link nav-button">Calendario de Tareas</a>
        <a href="{{ url_for('mis_reservas') }}" class="nav-link nav-button">Mis Reservas</a>
      {% endif %}
      <a href="{{ url_for('logout') }}" class="nav-link nav-button logout-button">Cerrar Sesi贸n</a>
    {% else %}
      <a href="{{ url_for('login') }}" class="nav-link nav-button">Iniciar Sesi贸n</a>
      <a href="{{ url_for('registro') }}" class="nav-link nav-button">Registrarse</a>
    {% endif %}
  </div>
</nav>
  </header>
  {% endblock %}

  <main class="container">
    {% block content %}{% endblock %}
  </main>

  <div class="footer-container">
    <footer>
      <p>&copy; 2025 El Capibara </p>
    </footer>
  </div>
  
  {% block scripts %}{% endblock %}
</body>
<script>
  function filtrarPorFecha() {
    const fechaInicioStr = document.getElementById('fecha_inicio').value;
    const fechaFinStr = document.getElementById('fecha_fin').value;

    const fechaInicio = fechaInicioStr ? new Date(fechaInicioStr) : null;
    const fechaFin = fechaFinStr ? new Date(fechaFinStr) : null;

    const filas = document.getElementById('tabla-instalaciones').getElementsByTagName('tbody')[0].getElementsByTagName('tr');

    for (let i = 0; i < filas.length; i++) {
      const fila = filas[i];
      const celdaFecha = fila.getElementsByTagName('td')[5]; // La sexta celda es la de la fecha
      if (celdaFecha) {
        const fechaCeldaStr = celdaFecha.innerText;
        const partesFecha = fechaCeldaStr.split('/');
        const fechaCelda = new Date(partesFecha[2], partesFecha[1] - 1, partesFecha[0]);
        
        let mostrarFila = true;

        if (fechaInicio && fechaCelda < fechaInicio) {
          mostrarFila = false;
        }
        if (fechaFin && fechaCelda > fechaFin) {
          mostrarFila = false;
        }

        fila.style.display = mostrarFila ? '' : 'none';
      }
    }
  }
</script>
</html>